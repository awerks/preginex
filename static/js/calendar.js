import{toast}from"./utils.js";function approveEvent(t,n){fetch(APPROVE_EVENT_URL_BASE+"/"+t,{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.success?(n.innerText="âœ… Approved",document.getElementById(t).innerText="Approved by: "+CURRENT_USERNAME,n.disabled=!0,n.classList.add("approved"),toast("Event approved successfully!","success")):toast(`Failed to approve the event.
`+e.error,"error"),console.log("Response data:",e)}).catch(e=>{console.error("Error approving event:",e),toast("An error occurred while approving the event.","error")})}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("eventCalendar"),t=window.innerWidth<768;new FullCalendar.Calendar(e,{initialView:t?"listWeek":"dayGridMonth",headerToolbar:t?{left:"prev,next",right:"today"}:{left:"title",right:"prev,next,dayGridMonth,timeGridWeek,timeGridDay,listWeek"},events:GET_EVENTS_URL,height:"auto",eventContent:function(t){var n=document.createElement("div"),r=(n.classList.add("fc-event-title"),n.innerText=t.event.title,document.createElement("div")),d=(r.classList.add("fc-event-requestedby"),r.innerText="Requested by: "+t.event.extendedProps.requested_by_username,document.createElement("div")),e=(d.classList.add("fc-event-approvedby"),d.id=t.event.extendedProps.event_id,d.innerText=t.event.extendedProps.approved_by_username?"Approved by: "+t.event.extendedProps.approved_by_username:"Pending approval",USER_ROLE);if(t.event.extendedProps.approved_by_username||!["Admin","Manager"].includes(e))return{domNodes:[n,r,d]};{let e=document.createElement("button");return e.innerText="Approve",e.classList.add("fc-approve-btn"),e.onclick=function(){approveEvent(t.event.extendedProps.event_id,e)},{domNodes:[n,r,d,e]}}},eventDidMount:function(e){e.event.extendedProps.description&&tippy(e.el,{content:"Description: "+e.event.extendedProps.description,placement:"top",arrow:!0})}}).render(),document.querySelector("form.event-form").addEventListener("submit",function(e){new Date(document.getElementById("event_date").value)<new Date?(e.preventDefault(),toast("Event date cannot be in the past.","error")):toast("Event created successfully!","success")})});